<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>CDM calibration under the G-DINA model framework — GDINA • GDINA</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="CDM calibration under the G-DINA model framework — GDINA"><meta property="og:description" content="GDINA calibrates the generalized deterministic inputs, noisy and
gate (G-DINA; de la Torre, 2011) model for dichotomous responses, and its extension, the sequential
G-DINA model (Ma, &amp;amp; de la Torre, 2016a; Ma, 2017) for ordinal and nominal responses.
By setting appropriate constraints, the deterministic inputs,
noisy and gate (DINA; de la Torre, 2009; Junker &amp;amp; Sijtsma, 2001) model,
the deterministic inputs, noisy or gate (DINO; Templin &amp;amp; Henson, 2006)
model, the reduced reparametrized unified model (R-RUM; Hartz, 2002),
the additive CDM (A-CDM; de la Torre, 2011), the linear logistic
model (LLM; Maris, 1999), and the multiple-strategy DINA model (MSDINA; de la Torre &amp;amp; Douglas, 2008; Huo &amp;amp; de la Torre, 2014)
can also be calibrated. Note that the LLM is equivalent to
the C-RUM (Hartz, 2002), a special case of the GDM (von Davier, 2008), and that the R-RUM
is also known as a special case of the generalized NIDA model (de la Torre, 2011).
In addition, users are allowed to specify design matrix and link function for each item, and
distinct models may be used in a single test for different items.
The attributes can be either dichotomous or polytomous
(Chen &amp;amp; de la Torre, 2013). Joint attribute distribution may be modelled using independent or saturated model,
structured model, higher-order model (de la Torre &amp;amp; Douglas, 2004), or loglinear model (Xu &amp;amp; von Davier, 2008).
Marginal maximum likelihood method with Expectation-Maximization (MMLE/EM) alogrithm is used for item parameter estimation.
To compare two or more GDINA objects, use method anova.
To calculate structural parameters for item and joint attribute distributions, use method coef.
To calculate lower-order incidental (person) parameters
use method personparm. To extract other components returned, use extract.
To plot item/category response function, use plot. To
check whether monotonicity is violated, use monocheck. To conduct anaysis in graphical user interface,
use startGDINA."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GDINA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.9.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/GDINA.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/OnlineExercises/CDMAnalysis_example.html">Model Estimation and Model Diagnostics</a>
    </li>
    <li>
      <a href="../articles/OnlineExercises/GDINA_example.html">GDINA Estimation</a>
    </li>
    <li>
      <a href="../articles/OnlineExercises/HOGDINA_example.html">Higher-order GDINA Estimation</a>
    </li>
    <li>
      <a href="../articles/OnlineExercises/LCDM_example.html">LCDM Estimation</a>
    </li>
    <li>
      <a href="../articles/OnlineExercises/sGDINA_analysis_example.html">Sequential G-DINA: Model Estimation and Model Diagnostics</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Wenchao-Ma/GDINA/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>CDM calibration under the G-DINA model framework</h1>
    <small class="dont-index">Source: <a href="https://github.com/Wenchao-Ma/GDINA/blob/HEAD/R/GDINA.R" class="external-link"><code>R/GDINA.R</code></a>, <a href="https://github.com/Wenchao-Ma/GDINA/blob/HEAD/R/anova.GDINA.R" class="external-link"><code>R/anova.GDINA.R</code></a>, <a href="https://github.com/Wenchao-Ma/GDINA/blob/HEAD/R/coef.R" class="external-link"><code>R/coef.R</code></a>, and 4 more</small>
    <div class="hidden name"><code>GDINA.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>GDINA</code> calibrates the generalized deterministic inputs, noisy and
gate (G-DINA; de la Torre, 2011) model for dichotomous responses, and its extension, the sequential
G-DINA model (Ma, &amp; de la Torre, 2016a; Ma, 2017) for ordinal and nominal responses.
By setting appropriate constraints, the deterministic inputs,
noisy and gate (DINA; de la Torre, 2009; Junker &amp; Sijtsma, 2001) model,
the deterministic inputs, noisy or gate (DINO; Templin &amp; Henson, 2006)
model, the reduced reparametrized unified model (R-RUM; Hartz, 2002),
the additive CDM (A-CDM; de la Torre, 2011), the linear logistic
model (LLM; Maris, 1999), and the multiple-strategy DINA model (MSDINA; de la Torre &amp; Douglas, 2008; Huo &amp; de la Torre, 2014)
can also be calibrated. Note that the LLM is equivalent to
the C-RUM (Hartz, 2002), a special case of the GDM (von Davier, 2008), and that the R-RUM
is also known as a special case of the generalized NIDA model (de la Torre, 2011).</p>
<p>In addition, users are allowed to specify design matrix and link function for each item, and
distinct models may be used in a single test for different items.
The attributes can be either dichotomous or polytomous
(Chen &amp; de la Torre, 2013). Joint attribute distribution may be modelled using independent or saturated model,
structured model, higher-order model (de la Torre &amp; Douglas, 2004), or loglinear model (Xu &amp; von Davier, 2008).
Marginal maximum likelihood method with Expectation-Maximization (MMLE/EM) alogrithm is used for item parameter estimation.</p>
<p>To compare two or more <code>GDINA</code> objects, use method <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></code>.</p>
<p>To calculate structural parameters for item and joint attribute distributions, use method <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></code>.</p>
<p>To calculate lower-order incidental (person) parameters
use method <code><a href="personparm.html">personparm</a></code>. To extract other components returned, use <code><a href="extract.html">extract</a></code>.
To plot item/category response function, use <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></code>. To
check whether monotonicity is violated, use <code><a href="monocheck.html">monocheck</a></code>. To conduct anaysis in graphical user interface,
use <code><a href="startGDINA.html">startGDINA</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">GDINA</span><span class="op">(</span></span>
<span>  <span class="va">dat</span>,</span>
<span>  <span class="va">Q</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"GDINA"</span>,</span>
<span>  sequential <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  att.dist <span class="op">=</span> <span class="st">"saturated"</span>,</span>
<span>  mono.constraint <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  linkfunc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  design.matrix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  no.bugs <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  att.prior <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  att.str <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  higher.order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  loglinear <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  catprob.parm <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  item.names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  solver <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nloptr.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  auglag.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  solnp.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'GDINA'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'GDINA'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  what <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"catprob"</span>, <span class="st">"delta"</span>, <span class="st">"gs"</span>, <span class="st">"itemprob"</span>, <span class="st">"LCprob"</span>, <span class="st">"rrum"</span>, <span class="st">"lambda"</span><span class="op">)</span>,</span>
<span>  withSE <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  SE.type <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'GDINA'</span></span>
<span><span class="fu"><a href="extract.html">extract</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">what</span>, SE.type <span class="op">=</span> <span class="fl">2</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'GDINA'</span></span>
<span><span class="fu"><a href="personparm.html">personparm</a></span><span class="op">(</span><span class="va">object</span>, what <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EAP"</span>, <span class="st">"MAP"</span>, <span class="st">"MLE"</span>, <span class="st">"mp"</span>, <span class="st">"HO"</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">4</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'GDINA'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'GDINA'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'GDINA'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/nobs.html" class="external-link">nobs</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'GDINA'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'GDINA'</span></span>
<span><span class="fu"><a href="npar.html">npar</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'GDINA'</span></span>
<span><span class="fu"><a href="indlogLik.html">indlogLik</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'GDINA'</span></span>
<span><span class="fu"><a href="indlogPost.html">indlogPost</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'GDINA'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>A required \(N \times J\) <code>matrix</code> or <code>data.frame</code> consisting of the
responses of \(N\) individuals to \(J\) items. Missing values need to be coded as <code>NA</code>.</p></dd>


<dt id="arg-q">Q<a class="anchor" aria-label="anchor" href="#arg-q"></a></dt>
<dd><p>A required matrix; The number of rows occupied by a single-strategy dichotomous item is 1, by a polytomous item is
the number of nonzero categories, and by a mutiple-strategy dichotomous item is the number of strategies.
The number of column is equal to the number of attributes if all items are single-strategy dichotomous items, but
the number of attributes + 2 if any items are polytomous or have multiple strategies.
For a polytomous item, the first column represents the item number and the second column indicates the nonzero category number.
For a multiple-strategy dichotomous item, the first column represents the item number and the second column indicates the strategy number.
For binary attributes, 1 denotes the attributes are measured by the items and 0 means the attributes are not
   measured. For polytomous attributes, non-zero elements indicate which level
   of attributes are needed (see Chen, &amp; de la Torre, 2013).  See <code>Examples</code>.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A vector for each item or nonzero category, or a scalar which will be used for all
items or nonzero categories to specify the CDMs fitted. The possible options
include <code>"GDINA"</code>,<code>"DINA"</code>,<code>"DINO"</code>,<code>"ACDM"</code>,<code>"LLM"</code>, <code>"RRUM"</code>, <code>"MSDINA"</code>, <code>"BUGDINO"</code>, <code>"SISM"</code>, and <code>"UDF"</code>. Note that
model can also be <code>"logitGDINA"</code> and <code>"logGDINA"</code>, indicating the saturated G-DINA model in logit and log link functions. They are
equivalent to the identity link saturated G-DINA model. The logit G-DINA model is identical to the log-linear CDM.
When <code>"UDF"</code>, indicating user defined function, is specified for any item, arguments <code>design.matrix</code> and <code>linkfunc</code> need to be specified.</p></dd>


<dt id="arg-sequential">sequential<a class="anchor" aria-label="anchor" href="#arg-sequential"></a></dt>
<dd><p>logical; <code>TRUE</code> if the sequential model is fitted for polytomous responses.</p></dd>


<dt id="arg-att-dist">att.dist<a class="anchor" aria-label="anchor" href="#arg-att-dist"></a></dt>
<dd><p>How is the joint attribute distribution estimated? It can be (1) <code>saturated</code>, which is the default, indicating that
the proportion parameter for each permissible latent class is estimated separately; (2) <code>higher.order</code>, indicating
that a higher-order joint attribute distribution is assumed (higher-order model can be specified in <code>higher.order</code> argument);
(3) <code>fixed</code>, indicating that the weights specified in <code>att.prior</code> argument are fixed in the estimation process.
If <code>att.prior</code> is not specified, a uniform joint attribute distribution is employed initially;  (4) <code>independent</code>, indicating
that all attributes are assumed to be independent; and (5) <code>loglinear</code>, indicating a loglinear model is employed.
If different groups have different joint attribute distributions,
specify <code>att.dist</code> as a character vector with the same number of elements as the number of groups. However, if a higher-order model is used for any group,
it must be used for all groups.</p></dd>


<dt id="arg-mono-constraint">mono.constraint<a class="anchor" aria-label="anchor" href="#arg-mono-constraint"></a></dt>
<dd><p>logical; <code>TRUE</code> indicates that \(P(\boldsymbol{\alpha}_1) &lt;=P(\boldsymbol{\alpha}_2)\) if
for all \(k\), \(\alpha_{1k} &lt; \alpha_{2k}\). Can be a vector for each item or nonzero category or a scalar which will be used for all
items to specify whether monotonicity constraint should be added.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>a factor or a vector indicating the group each individual belongs to. Its length must be equal to the number of individuals.</p></dd>


<dt id="arg-linkfunc">linkfunc<a class="anchor" aria-label="anchor" href="#arg-linkfunc"></a></dt>
<dd><p>a vector of link functions for each item/category; It can be <code>"identity"</code>,<code>"log"</code> or <code>"logit"</code>. Only applicable
when, for some items, <code>model="UDF"</code>.</p></dd>


<dt id="arg-design-matrix">design.matrix<a class="anchor" aria-label="anchor" href="#arg-design-matrix"></a></dt>
<dd><p>a list of design matrices; Its length must be equal to the number of items (or nonzero categories for sequential models).
If CDM for item j is specified as "UDF" in argument <code>model</code>, the corresponding design matrix must be provided; otherwise, the design matrix can be <code>NULL</code>,
which will be generated automatically.</p></dd>


<dt id="arg-no-bugs">no.bugs<a class="anchor" aria-label="anchor" href="#arg-no-bugs"></a></dt>
<dd><p>A numeric scalar (whole numbers only) indicating the number of bugs or misconceptions in the Q-matrix. The bugs must be included in the last <code>no.bugs</code> columns.
It can be used along with the <code>BUGDINO</code> and <code>SISM</code> models (see, Kuo, Chen, Yang &amp; Mok, 2016; Kuo, Chen, &amp; de la Torre, 2018). This argument will be ignored if the
model is not specified in <code>model</code> argument. Note that the <code>BUGDINO</code> and <code>SISM</code> models are reparametrized - see <code>Details</code> below. By default,
<code>no.bugs</code>=0, implying that there is no bugs/misconceptions.</p></dd>


<dt id="arg-att-prior">att.prior<a class="anchor" aria-label="anchor" href="#arg-att-prior"></a></dt>
<dd><p>A vector of length \(2^K\) for single group model, or a matrix of dimension \(2^K\times\) no. of groups to specify
attribute prior distribution for \(2^K\) latent classes for all groups under a multiple group model. Only applicable for dichotomous attributes.
The sum of all elements does not have to be equal to 1; however, it will be normalized so that the sum is equal to 1
before calibration.
The label for each latent class can be obtained by calling <code>attributepattern(K)</code>. See <code>examples</code> for more info.</p></dd>


<dt id="arg-att-str">att.str<a class="anchor" aria-label="anchor" href="#arg-att-str"></a></dt>
<dd><p>Specify attribute structures. <code>NULL</code>, by default, means there is no structure. Attribute structure needs be specified as a list -
which will be internally handled by <code>att.structure</code> function. See examples. It can also be a matrix giving all permissible attribute profiles.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>How to print calibration information
after each EM iteration? Can be 0, 1 or 2, indicating to print no information,
information for current iteration, or information for all iterations.</p></dd>


<dt id="arg-higher-order">higher.order<a class="anchor" aria-label="anchor" href="#arg-higher-order"></a></dt>
<dd><p>A list specifying the higher-order joint attribute distribution with the following components:</p><ul><li><p><code>model</code> - a number indicating the model for higher-order joint attribute distribution. Can be
  1, 2 or 3, representing the intercept only approach, common slope approach and varied slope approach (see <code>Details</code>).</p></li>
<li><p><code>nquad</code> - a scalar specifying the number of integral nodes. Default = 25.</p></li>
<li><p><code>SlopeRange</code> - a vector of length two specifying the range of slope parameters. Default = [0.1, 5].</p></li>
<li><p><code>InterceptRange</code> - a vector of length two specifying the range of intercept parameters. Default = [-4, 4].</p></li>
<li><p><code>SlopePrior</code> - a vector of length two specifying the mean and variance of log(slope) parameters, which are assumed normally distributed. Default: mean = 0 and sd = 0.25.</p></li>
<li><p><code>InterceptPrior</code> - a vector of length two specifying the mean and variance of intercept parameters, which are assumed normally distributed. Default: mean = 0 and sd = 1.</p></li>
<li><p><code>Prior</code> - logical; indicating whether prior distributions should be imposed to slope and intercept parameters. Default is <code>FALSE</code>.</p></li>
</ul></dd>


<dt id="arg-loglinear">loglinear<a class="anchor" aria-label="anchor" href="#arg-loglinear"></a></dt>
<dd><p>the order of loglinear smooth for attribute space. It can be either 1 or 2 indicating the loglinear model with main effect only
and with main effect and first-order interaction; It can also be a matrix, representing the design matrix for the loglinear model.</p></dd>


<dt id="arg-catprob-parm">catprob.parm<a class="anchor" aria-label="anchor" href="#arg-catprob-parm"></a></dt>
<dd><p>A list of initial success probability parameters for each nonzero category.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A list of control parameters with elements:</p><ul><li><p><code>maxitr</code> A vector for each item or nonzero category, or a scalar which will be used for all
   items or nonzero categories to specify the maximum number of EM cycles allowed. Default = 2000.</p></li>
<li><p><code>conv.crit</code> The convergence criterion. Default = 0.0001.</p></li>
<li><p><code>conv.type</code> How is the convergence criterion evaluated? A vector with possible elements: <code>"ip"</code>, indicating
   the maximum absolute change in item success probabilities, <code>"mp"</code>, representing
   the maximum absolute change in mixing proportion parameters, <code>"delta"</code>, indicating the maximum absolute change in delta
   parameters, <code>neg2LL</code> indicating the absolute change in negative two times loglikeihood,  or <code>neg2LL</code> indicating the
   relative absolute change in negative two times loglikeihood (i.e., the absolute change divided by -2LL of the previous iteration).
   Multiple criteria can be specified. If so, all criteria need to be met. Default = c("ip", "mp").</p></li>
<li><p><code>nstarts</code> how many sets of starting values? Default = 3.</p></li>
<li><p><code>lower.p</code> A vector for each item or nonzero category,
   or a scalar which will be used for all items or nonzero categories to specify the lower bound for success probabilities.
   Default = .0001.</p></li>
<li><p><code>upper.p</code> A vector for each item or nonzero category, or a scalar which will be used for all
   items or nonzero categories to specify the upper bound for success probabilities. Default = .9999.</p></li>
<li><p><code>lower.prior</code> The lower bound for mixing proportion parameters (latent class sizes). Default = .Machine$double.eps.</p></li>
<li><p><code>randomseed</code> Random seed for generating initial item parameters. Default = 123456.</p></li>
<li><p><code>smallNcorrection</code> A numeric vector with two elements specifying the corrections applied when the expected number of
individuals in some latent groups are too small. If the expected no. of examinees is less than the second element,
the first element and two times the first element will be added to the numerator and denominator of the closed-form solution of
probabilities of success. Only applicable for the G-DINA, DINA and DINO model estimation without monotonic constraints.</p></li>
<li><p><code>MstepMessage</code> Integer; Larger number prints more information from Mstep optimizer. Default = 1.</p></li>
</ul></dd>


<dt id="arg-item-names">item.names<a class="anchor" aria-label="anchor" href="#arg-item-names"></a></dt>
<dd><p>A vector giving the item names. By default, items are named as "Item 1", "Item 2", etc.</p></dd>


<dt id="arg-solver">solver<a class="anchor" aria-label="anchor" href="#arg-solver"></a></dt>
<dd><p>A string indicating which solver should be used in M-step. By default, the solver is automatically chosen according to the models specified.
Possible options include <a href="https://astamm.github.io/nloptr/reference/slsqp.html" class="external-link">slsqp</a>, <a href="https://astamm.github.io/nloptr/reference/nloptr.html" class="external-link">nloptr</a>, <a href="https://rdrr.io/pkg/Rsolnp/man/solnp.html" class="external-link">solnp</a> and <a href="https://rdrr.io/pkg/alabama/man/auglag.html" class="external-link">auglag</a>.</p></dd>


<dt id="arg-nloptr-args">nloptr.args<a class="anchor" aria-label="anchor" href="#arg-nloptr-args"></a></dt>
<dd><p>a list of control parameters to be passed to <code>opts</code> argument of <a href="https://astamm.github.io/nloptr/reference/nloptr.html" class="external-link">nloptr</a> function.</p></dd>


<dt id="arg-auglag-args">auglag.args<a class="anchor" aria-label="anchor" href="#arg-auglag-args"></a></dt>
<dd><p>a list of control parameters to be passed to the alabama::auglag() function. It can contain two elements:
<code>control.outer</code> and <code>control.optim</code>. See <a href="https://rdrr.io/pkg/alabama/man/auglag.html" class="external-link">auglag</a>.</p></dd>


<dt id="arg-solnp-args">solnp.args<a class="anchor" aria-label="anchor" href="#arg-solnp-args"></a></dt>
<dd><p>a list of control parameters to be passed to <code>control</code> argument of <a href="https://rdrr.io/pkg/Rsolnp/man/solnp.html" class="external-link">solnp</a> function.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>GDINA object for various S3 methods</p></dd>


<dt id="arg-what">what<a class="anchor" aria-label="anchor" href="#arg-what"></a></dt>
<dd><p>argument for various S3 methods; For calculating structural parameters using <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></code>,
<code>what</code> can be</p><ul><li><p><code>itemprob</code> - item success probabilities of each reduced attribute pattern.</p></li>
<li><p><code>catprob</code> - category success probabilities of each reduced attribute pattern; the same as <code>itemprob</code> for dichtomous response data.</p></li>
<li><p><code>LCprob</code> - item success probabilities of each attribute pattern.</p></li>
<li><p><code>gs</code> - guessing and slip parameters of each item/category.</p></li>
<li><p><code>delta</code> - delta parameters of each item/category, see G-DINA formula in details.</p></li>
<li><p><code>rrum</code> - RRUM parameters when items are estimated using <code>RRUM</code>.</p></li>
<li><p><code>lambda</code> - structural parameters for joint attribute distribution.</p></li>
</ul><p>For calculating incidental parameters using <code><a href="personparm.html">personparm</a></code>,
<code>what</code> can be</p><ul><li><p><code>EAP</code> - EAP estimates of attribute pattern.</p></li>
<li><p><code>MAP</code> - MAP estimates of attribute pattern.</p></li>
<li><p><code>MLE</code> - MLE estimates of attribute pattern.</p></li>
<li><p><code>mp</code> -  marginal mastery probabilities.</p></li>
<li><p><code>HO</code> -  EAP estimates of higher-order ability if a higher-order is fitted.</p></li>
</ul></dd>


<dt id="arg-withse">withSE<a class="anchor" aria-label="anchor" href="#arg-withse"></a></dt>
<dd><p>argument for method <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></code>; estimate standard errors or not?</p></dd>


<dt id="arg-se-type">SE.type<a class="anchor" aria-label="anchor" href="#arg-se-type"></a></dt>
<dd><p>type of standard errors. For now, SEs are calculated based on outper-product of gradient.
It can be <code>1</code> based on item-wise information, <code>2</code> based on incomplete information and <code>3</code>
based on complete information.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>How many decimal places in each number? The default is 4.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>GDINA</code> returns an object of class <code>GDINA</code>. Methods for <code>GDINA</code> objects
 include <code><a href="extract.html">extract</a></code> for extracting various components, <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></code>
 for extracting structural parameters, <code><a href="personparm.html">personparm</a></code>
 for calculating incidental (person) parameters, <code>summary</code> for summary information.
 <code>AIC</code>, <code>BIC</code>,<code>logLik</code>, <code>deviance</code> and <code>npar</code> can also be used to
 calculate AIC, BIC, observed log-likelihood, deviance and number of parameters.</p>
    </div>
    <div id="methods-by-generic-">
    <h2>Methods (by generic)</h2>

<ul><li><p><code>anova(GDINA)</code>: Model comparison using likelihood ratio test</p></li>
<li><p><code>coef(GDINA)</code>: extract structural parameter estimates</p></li>
<li><p><code>extract(GDINA)</code>: extract various elements of GDINA estimates</p></li>
<li><p><code>personparm(GDINA)</code>: calculate person attribute patterns and higher-order ability</p></li>
<li><p><code>logLik(GDINA)</code>: calculate log-likelihood</p></li>
<li><p><code>deviance(GDINA)</code>: calculate deviance</p></li>
<li><p><code>nobs(GDINA)</code>: calculate number of observations</p></li>
<li><p><code>vcov(GDINA)</code>: calculate covariance-matrix for delta parameters</p></li>
<li><p><code>npar(GDINA)</code>: calculate the number of parameters</p></li>
<li><p><code>indlogLik(GDINA)</code>: extract log-likelihood for each individual</p></li>
<li><p><code>indlogPost(GDINA)</code>: extract log posterior for each individual</p></li>
<li><p><code>summary(GDINA)</code>: print summary information</p></li>
</ul></div>
    <div id="note">
    <h2>Note</h2>
    <p>anova function does NOT check whether models compared are nested or not.</p>
    </div>
    <div id="the-g-dina-model">
    <h2>The G-DINA model</h2>



<p>The generalized DINA model (G-DINA; de la Torre, 2011) is an extension of the DINA model.
Unlike the DINA model, which collaspes all latent classes into two latent groups for
each item, if item \(j\) requires \(K_j^*\)
attributes, the G-DINA model collapses \(2^K\) latent classes into \(2^{K_j^*}\)
latent groups with unique success probabilities on item \(j\), where
\(K_j^*=\sum_{k=1}^{K}q_{jk}\).</p>
<p>Let \(\boldsymbol{\alpha}_{lj}^*\) be the reduced attribute
pattern consisting of the columns of the attributes required by item \(j\), where
\(l=1,\ldots,2^{K_j^*}\). For example, if only the first and the last attributes are
required, \(\boldsymbol{\alpha}_{lj}^*=(\alpha_{l1},\alpha_{lK})\). For notational
convenience, the first \(K_j^*\) attributes can be assumed to be the required attributes
for item \(j\) as in de la Torre (2011). The probability of success \(P(X_{j}=1|\boldsymbol{\alpha}_{lj}^*)\) is denoted
by \(P(\boldsymbol{\alpha}_{lj}^*)\). To model this probability of success, different link functions
as in the generalized linear models are used in the G-DINA model. The item response
function of the G-DINA model using the identity link can be written as
$$
f[P(\boldsymbol{\alpha}_{lj}^*)]=\delta_{j0}+\sum_{k=1}^{K_j^*}\delta_{jk}\alpha_{lk}+
\sum_{k'=k+1}^{K_j^*}\sum_{k=1}^{K_j^*-1}\delta_{jkk'}\alpha_{lk}\alpha_{lk'}+\cdots+
\delta_{j12{\cdots}K_j^*}\prod_{k=1}^{K_j^*}\alpha_{lk},
$$
or in matrix form,
$$
f[\boldsymbol{P}_j]=\boldsymbol{M}_j\boldsymbol{\delta}_j,
$$
where \(\delta_{j0}\) is the intercept for item \(j\), \(\delta_{jk}\) is the main effect
due to \(\alpha_{lk}\), \(\delta_{jkk'}\) is the interaction effect due to
\(\alpha_{lk}\) and \(\alpha_{lk'}\), \(\delta_{j12{\ldots}K_j^*}\) is the interaction
effect due to \(\alpha_{l1}, \cdots,\alpha_{lK_j^*}\). The log and logit links can also
be employed.</p>
    </div>
    <div id="other-cdms-as-special-cases">
    <h2>Other CDMs as special cases</h2>



<p>Several widely used CDMs can be obtained by setting appropriate constraints to the G-DINA model.
This section introduces the parameterization
of different CDMs within the G-DINA model framework very breifly. Readers interested in this please refer to
de la Torre(2011) for details.</p>
<dl><dt><code>DINA model</code></dt>
<dd><p>In DINA model, each item has two item parameters - guessing (\(g\)) and slip (\(s\)). In traditional
       parameterization of the DINA model, a latent variable \(\eta\) for person \(i\) and
       item \(j\) is defined as
       $$\eta_{ij}=\prod_{k=1}^K\alpha_{ik}^{q_{jk}}$$
       Briefly speaking, if individual \(i\) master all attributes required by item \(j\),
       \(\eta_{ij}=1\); otherwise, \(\eta_{ij}=0\).
       Item response function of the DINA model can be written by
       $$P(X_{ij}=1|\eta_{ij})=(1-s_j)^{\eta_{ij}}g_j^{1-\eta_{ij}}$$
       To obtain the DINA model from the G-DINA model,
       all terms in identity link G-DINA model except \(\delta_0\) and \(\delta_{12{\ldots}K_j^*}\)
       need to be fixed to zero, that is,
       $$P(\boldsymbol{\alpha}_{lj}^*)=
       \delta_{j0}+\delta_{j12{\cdots}K_j^*}\prod_{k=1}^{K_j^*}\alpha_{lk}$$
       In this parameterization, \(\delta_{j0}=g_j\) and \(\delta_{j0}+\delta_{j12{\cdots}K_j^*}=1-s_j\).</p></dd>

<dt><code>DINO model</code></dt>
<dd><p>The DINO model can be given by
       $$P(\boldsymbol{\alpha}_{lj}^{*})=
       \delta_{j0}+\delta_{j1}I(\boldsymbol{\alpha}_{lj}^*\neq \boldsymbol{0})$$</p>
<p>where \(I(\cdot)\) is an indicator variable. The DINO model is also a constrained identity
       link G-DINA model. As shown by de la Torre (2011), the appropriate constraint is
       $$\delta_{jk}=-\delta_{jk^{'}k^{''}}=\cdots=(-1)^{K_j^*+1}\delta_{j12{\cdots}K_j^*},$$ for
       \(k=1,\cdots,K_j^*, k^{'}=1,\cdots,K_j^*-1\), and \(k^{''}&gt;k^{'},\cdots,K_j^*\).</p></dd>

<dt><code>Additive models with different link functions</code></dt>
<dd><p>The A-CDM, LLM and R-RUM can be obtained by setting all interactions to be zero in
       identity, logit and log link G-DINA model, respectively. Specifically, the A-CDM can be formulated as
       $$P(\boldsymbol{\alpha}_{lj}^*)=
       \delta_{j0}+\sum_{k=1}^{K_j^*}\delta_{jk}\alpha_{lk}$$
       The item response function for
       LLM can be given by
       $$ logit[P(\boldsymbol{\alpha}_{lj}^*)]=\delta_{j0}+\sum_{k=1}^{K_j^*}\delta_{jk}\alpha_{lk},$$
       and lastly, the RRUM, can be written as
       $$log[P(\boldsymbol{\alpha}_{lj}^*)]=\delta_{j0}+\sum_{k=1}^{K_j^*}\delta_{jk}\alpha_{lk}.$$ It should be
       noted that the LLM is equivalent to the compensatory RUM, which is subsumed by the GDM, and that
       the RRUM is a special case of the generalized noisy inputs, deterministic “And" gate model (G-NIDA).</p></dd>

<dt><code>Simultaneously identifying skills and misconceptions (SISM)</code></dt>
<dd><p>The SISM can be can be reformulated as
       $$P(\boldsymbol{\alpha}_{lj}^*)=
       \delta_{j0}+\delta_{j1}I[{mastering all skills}]+
       \delta_{j2}I[{having no bugs}]+\delta_{j12}I[{mastering all skills and having no bugs}].$$
       As a result,the success probability of students who have mastered all the measured skills and possess
       none of the measured misconceptions (\(h_j\) in Equation 4 of Kuo, et al, 2018) is
       \(\delta_{j0}+\delta_{j1}+\delta_{j2}+\delta_{j12}\), the success probability of students who have
       mastered all the measured skills but possess some of the measured misconceptions (\(\omega_j\))
         is \(\delta_{j0}+\delta_{j1}\), the success probability of students who have not mastered all the
         measured skills and possess none of the measured misconceptions (\(g_j\)) is
         \(\delta_{j0}+\delta_{j2}\) and success probability of students who have not mastered all the
         measured skills and possess at least one of the measured misconceptions(\(\epsilon_j\)) is
         \(\delta_{j0}\).</p>
<p>By specifying <code>no.bugs</code> being equal to the number of attributes, the Bug-DINO is obtained, as in
         $$P(\boldsymbol{\alpha}_{lj}^*)=\delta_{j0}+\delta_{j1}I[{having no bugs}].$$</p></dd>


</dl></div>
    <div id="joint-attribute-distribution">
    <h2>Joint Attribute Distribution</h2>



<p>The joint attribute distribution can be modeled using various methods. This section mainly focuses on the so-called
higher-order approach, which was originally proposed by de la Torre
and Douglas (2004) for the DINA model. It has been extended in this package for all condensation rules.
Particularly, three approaches are available for the higher-order attribute structure:
intercept only approach, common slope approach and varied slope approach.
For the intercept only approach, the probability of mastering attribute \(k\) for individual \(i\) is defined as
$$P(\alpha_k=1|\theta_i,\lambda_{0k})=\frac{exp(\theta_i+\lambda_{0k})}{1+exp(\theta_i+\lambda_{0k})}$$
For the common slope approach, the probability of mastering attribute \(k\) for individual \(i\) is defined as
$$P(\alpha_k=1|\theta_i,\lambda_{0k},\lambda_{1})=\frac{exp(\lambda_{1}\theta_i+\lambda_{0k})}{1+exp(\lambda_{1}\theta_i+\lambda_{0k})}$$
For the varied slope approach, the probability of mastering attribute \(k\) for individual \(i\) is defined as
$$P(\alpha_k=1|\theta_i,\lambda_{0k},\lambda_{1k})=\frac{exp(\lambda_{1k}\theta_i+\lambda_{0k})}{1+exp(\lambda_{1k}\theta_i+\lambda_{0k})}$$
where \(\theta_i\) is the ability of examinee \(i\). \(\lambda_{0k}\) and \(\lambda_{1k}\) are the intercept
and slope parameters for attribute \(k\), respectively.
The probability of joint attributes can be written as
 $$P(\boldsymbol{\alpha}|\theta_i,\boldsymbol{\lambda})=\prod_k P(\alpha_k|\theta_i,\boldsymbol{\lambda})$$.</p>
    </div>
    <div id="model-estimation">
    <h2>Model Estimation</h2>



<p>The MMLE/EM algorithm is implemented in this package. For G-DINA, DINA and DINO models, closed-form solutions exist.
See de la Torre (2009) and de la Torre (2011) for details.
For ACDM, LLM and RRUM, closed-form solutions do not exist, and therefore some general optimization techniques are
adopted in M-step (Ma, Iaconangelo &amp; de la Torre, 2016). The selection of optimization techniques mainly depends on whether
some specific constraints need to be added.</p>
<p>The sequential G-DINA model is a special case of the diagnostic tree model (DTM; Ma, 2019) and estimated using
the mapping matrix accordingly (See Tutz, 1997; Ma, 2019).</p>
    </div>
    <div id="the-number-of-parameters">
    <h2>The Number of Parameters</h2>



<p>For dichotomous response models:
Assume a test measures \(K\) attributes and item \(j\) requires \(K_j^*\) attributes:
The DINA and DINO model has 2 item parameters for each item;
if item \(j\) is ACDM, LLM or RRUM, it has \(K_j^*+1\) item parameters; if it is G-DINA model, it has \(2^{K_j^*}\) item parameters.
Apart from item parameters, the parameters involved in the estimation of joint attribute distribution need to be estimated as well.
When using the saturated attribute structure, there are \(2^K-1\) parameters for joint attribute distribution estimation; when
using a higher-order attribute structure, there are \(K\), \(K+1\), and \(2\times K\) parameters for the intercept only approach, common slope approach and varied slope approach, respectively.
For polytomous response data using the sequential G-DINA model, the number of item parameters
are counted at category level.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Bock, R. D., &amp; Aitkin, M. (1981). Marginal maximum likelihood estimation of item parameters: Application of an EM algorithm. <em>Psychometrika, 46</em>, 443-459.</p>
<p>Bock, R. D., &amp; Lieberman, M. (1970). Fitting a response model forn dichotomously scored items. <em>Psychometrika, 35</em>, 179-197.</p>
<p>Bor-Chen Kuo, Chun-Hua Chen, Chih-Wei Yang, &amp; Magdalena Mo Ching Mok. (2016). Cognitive diagnostic models for tests with multiple-choice and constructed-response items. <em>Educational Psychology, 36</em>, 1115-1133.</p>
<p>Carlin, B. P., &amp; Louis, T. A. (2000). Bayes and empirical bayes methods for data analysis. New York, NY: Chapman &amp; Hall</p>
<p>de la Torre, J., &amp; Douglas, J. A. (2008). Model evaluation and multiple strategies in cognitive diagnosis: An analysis of fraction subtraction data. <em>Psychometrika, 73</em>, 595-624.</p>
<p>de la Torre, J. (2009). DINA Model and Parameter Estimation: A Didactic. <em>Journal of Educational and Behavioral Statistics, 34</em>, 115-130.</p>
<p>de la Torre, J. (2011). The generalized DINA model framework. <em>Psychometrika, 76</em>, 179-199.</p>
<p>de la Torre, J., &amp; Douglas, J. A. (2004). Higher-order latent trait models for cognitive diagnosis. <em>Psychometrika, 69</em>, 333-353.</p>
<p>de la Torre, J., &amp; Lee, Y. S. (2013). Evaluating the wald test for item-level comparison of
saturated and reduced models in cognitive diagnosis. <em>Journal of Educational Measurement, 50</em>, 355-373.</p>
<p>Haertel, E. H. (1989). Using restricted latent class models to map the skill structure of achievement items.
<em>Journal of Educational Measurement, 26</em>, 301-321.</p>
<p>Hartz, S. M. (2002). A bayesian framework for the unified model for assessing cognitive abilities:
Blending theory with practicality (Unpublished doctoral dissertation). University of Illinois at Urbana-Champaign.</p>
<p>Huo, Y., &amp; de la Torre, J. (2014). Estimating a Cognitive Diagnostic Model for Multiple Strategies via the EM Algorithm. <em>Applied Psychological Measurement, 38</em>, 464-485.</p>
<p>Junker, B. W., &amp; Sijtsma, K. (2001). Cognitive assessment models with few assumptions, and connections with nonparametric
item response theory. <em>Applied Psychological Measurement, 25</em>, 258-272.</p>
<p>Kuo, B.-C., Chen.-H., &amp; de la Torre,J. (2018). A cognitive diagnosis model for identifying coexisting skills and misconceptions.<em>Applied Psychological Measuremet</em>, 179–191.</p>
<p>Ma, W., &amp; de la Torre, J. (2016). A sequential cognitive diagnosis model for polytomous responses. <em>British Journal of Mathematical and Statistical Psychology. 69,</em> 253-275.</p>
<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.</p>
<p>Ma, W. (2019). A diagnostic tree model for polytomous responses with multiple strategies. <em>British Journal of Mathematical and Statistical Psychology, 72</em>, 61-82.</p>
<p>Ma, W., Iaconangelo, C., &amp; de la Torre, J. (2016). Model similarity, model selection and attribute classification. <em>Applied Psychological Measurement, 40</em>, 200-217.</p>
<p>Ma, W. (2017). <em>A Sequential Cognitive Diagnosis Model for Graded Response: Model Development, Q-Matrix Validation,and Model Comparison. Unpublished doctoral dissertation.</em> New Brunswick, NJ: Rutgers University.</p>
<p>Maris, E. (1999). Estimating multiple classification latent class models. <em>Psychometrika, 64</em>, 187-212.</p>
<p>Tatsuoka, K. K. (1983). Rule space: An approach for dealing with misconceptions based on item response theory. <em>Journal of Educational Measurement, 20</em>, 345-354.</p>
<p>Templin, J. L., &amp; Henson, R. A. (2006). Measurement of psychological disorders using cognitive diagnosis models. <em>Psychological Methods, 11</em>, 287-305.</p>
<p>Tutz, G. (1997). Sequential models for ordered responses. In W.J. van der Linden &amp; R. K. Hambleton (Eds.), Handbook of modern item response theory p. 139-152). New York, NY: Springer.</p>
<p>Xu, X., &amp; von Davier, M. (2008). Fitting the structured general diagnostic model to NAEP data. ETS research report, RR-08-27.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>See <code><a href="autoGDINA.html">autoGDINA</a></code> for Q-matrix validation, item-level model comparison and model calibration
in one run; See <code><a href="modelfit.html">modelfit</a></code> and <code><a href="itemfit.html">itemfit</a></code> for model and item fit analysis, <code><a href="Qval.html">Qval</a></code> for Q-matrix validation,
<code><a href="modelcomp.html">modelcomp</a></code> for item level model comparison and <code><a href="simGDINA.html">simGDINA</a></code> for data simulation.
<code><a href="GMSCDM.html">GMSCDM</a></code> for a series of multiple strategy CDMs for dichotomous data,
and <code><a href="DTM.html">DTM</a></code> for diagnostic tree model for multiple strategies in polytomous response data
Also see <code>gdina</code> in <span class="pkg">CDM</span> package for the G-DINA model estimation.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Wenchao Ma, The University of Minnesota, <a href="mailto:wma@umn.edu">wma@umn.edu</a>
Jimmy de la Torre, The University of Hong Kong</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#        Example 1.                #</span></span></span>
<span class="r-in"><span><span class="co">#     GDINA, DINA, DINO            #</span></span></span>
<span class="r-in"><span><span class="co">#    ACDM, LLM and RRUM            #</span></span></span>
<span class="r-in"><span><span class="co"># estimation and comparison        #</span></span></span>
<span class="r-in"><span><span class="co">#                                  #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#--------GDINA model --------#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"GDINA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod1</span></span></span>
<span class="r-in"><span><span class="co"># summary information</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> <span class="co">#AIC</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> <span class="co">#BIC</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> <span class="co">#log-likelihood value</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html" class="external-link">deviance</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> <span class="co"># deviance: -2 log-likelihood</span></span></span>
<span class="r-in"><span><span class="fu"><a href="npar.html">npar</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> <span class="co"># number of parameters</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="indlogLik.html">indlogLik</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span><span class="op">)</span> <span class="co"># individual log-likelihood</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="indlogPost.html">indlogPost</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span><span class="op">)</span> <span class="co"># individual log-posterior</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># structural parameters</span></span></span>
<span class="r-in"><span><span class="co"># see ?coef</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> <span class="co"># item probabilities of success for each latent group</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod1</span>, withSE <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># item probabilities of success &amp; standard errors</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod1</span>, what <span class="op">=</span> <span class="st">"delta"</span><span class="op">)</span> <span class="co"># delta parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod1</span>, what <span class="op">=</span> <span class="st">"delta"</span>,withSE<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co"># delta parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod1</span>, what <span class="op">=</span> <span class="st">"gs"</span><span class="op">)</span> <span class="co"># guessing and slip parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod1</span>, what <span class="op">=</span> <span class="st">"gs"</span>,withSE <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># guessing and slip parameters &amp; standard errors</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># person parameters</span></span></span>
<span class="r-in"><span><span class="co"># see ?personparm</span></span></span>
<span class="r-in"><span><span class="fu"><a href="personparm.html">personparm</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span> <span class="co"># EAP estimates of attribute profiles</span></span></span>
<span class="r-in"><span><span class="fu"><a href="personparm.html">personparm</a></span><span class="op">(</span><span class="va">mod1</span>, what <span class="op">=</span> <span class="st">"MAP"</span><span class="op">)</span> <span class="co"># MAP estimates of attribute profiles</span></span></span>
<span class="r-in"><span><span class="fu"><a href="personparm.html">personparm</a></span><span class="op">(</span><span class="va">mod1</span>, what <span class="op">=</span> <span class="st">"MLE"</span><span class="op">)</span> <span class="co"># MLE estimates of attribute profiles</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#plot item response functions for item 10</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,item <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,item <span class="op">=</span> <span class="fl">10</span>,withSE <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># with error bars</span></span></span>
<span class="r-in"><span><span class="co">#plot mastery probability for individuals 1, 20 and 50</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span>,what <span class="op">=</span> <span class="st">"mp"</span>, person <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">20</span>,<span class="fl">50</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use extract function to extract more components</span></span></span>
<span class="r-in"><span><span class="co"># See ?extract</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ------- DINA model --------#</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"DINA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod2</span>, what <span class="op">=</span> <span class="st">"gs"</span><span class="op">)</span> <span class="co"># guess and slip parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod2</span>, what <span class="op">=</span> <span class="st">"gs"</span>,withSE <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># guess and slip parameters and standard errors</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model comparison at the test level via likelihood ratio test</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod1</span>,<span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># -------- DINO model -------#</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"DINO"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#slip and guessing</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod3</span>, what <span class="op">=</span> <span class="st">"gs"</span><span class="op">)</span> <span class="co"># guess and slip parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod3</span>, what <span class="op">=</span> <span class="st">"gs"</span>,withSE <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># guess and slip parameters + standard errors</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model comparison at test level via likelihood ratio test</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod1</span>,<span class="va">mod2</span>,<span class="va">mod3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --------- ACDM model -------#</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"ACDM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod4</span></span></span>
<span class="r-in"><span><span class="co"># --------- LLM model -------#</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="va">mod4b</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"LLM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod4b</span></span></span>
<span class="r-in"><span><span class="co"># --------- RRUM model -------#</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="va">mod4c</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"RRUM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod4c</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- Different CDMs for different items --- #</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"GDINA"</span>,<span class="fl">3</span><span class="op">)</span>,<span class="st">"LLM"</span>,<span class="st">"DINA"</span>,<span class="st">"DINO"</span>,<span class="st">"ACDM"</span>,<span class="st">"RRUM"</span>,<span class="st">"LLM"</span>,<span class="st">"RRUM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod5</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="va">models</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">mod1</span>,<span class="va">mod2</span>,<span class="va">mod3</span>,<span class="va">mod4</span>,<span class="va">mod4b</span>,<span class="va">mod4c</span>,<span class="va">mod5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#        Example 2.                #</span></span></span>
<span class="r-in"><span><span class="co">#        Model estimations         #</span></span></span>
<span class="r-in"><span><span class="co"># With monotonocity constraints    #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="co"># for item 10 only</span></span></span>
<span class="r-in"><span><span class="va">mod11</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"GDINA"</span>,mono.constraint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>,<span class="fl">9</span><span class="op">)</span>,<span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod11</span></span></span>
<span class="r-in"><span><span class="va">mod11a</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"DINA"</span>,mono.constraint <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod11a</span></span></span>
<span class="r-in"><span><span class="va">mod11b</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"ACDM"</span>,mono.constraint <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod11b</span></span></span>
<span class="r-in"><span><span class="va">mod11c</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"LLM"</span>,mono.constraint <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod11c</span></span></span>
<span class="r-in"><span><span class="va">mod11d</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"RRUM"</span>,mono.constraint <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod11d</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod11d</span>,<span class="st">"delta"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod11d</span>,<span class="st">"rrum"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#           Example 3a.            #</span></span></span>
<span class="r-in"><span><span class="co">#        Model estimations         #</span></span></span>
<span class="r-in"><span><span class="co"># With Higher-order att structure  #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="co"># --- Higher order G-DINA model ---#</span></span></span>
<span class="r-in"><span><span class="va">mod12</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"DINA"</span>,</span></span>
<span class="r-in"><span>               att.dist<span class="op">=</span><span class="st">"higher.order"</span>,higher.order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>nquad<span class="op">=</span><span class="fl">31</span>,model <span class="op">=</span> <span class="st">"2PL"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="personparm.html">personparm</a></span><span class="op">(</span><span class="va">mod12</span>,<span class="st">"HO"</span><span class="op">)</span> <span class="co"># higher-order ability</span></span></span>
<span class="r-in"><span><span class="co"># structural parameters</span></span></span>
<span class="r-in"><span><span class="co"># first column is slope and the second column is intercept</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod12</span>,<span class="st">"lambda"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># --- Higher order DINA model ---#</span></span></span>
<span class="r-in"><span><span class="va">mod22</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"DINA"</span>, att.dist<span class="op">=</span><span class="st">"higher.order"</span>,</span></span>
<span class="r-in"><span>               higher.order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"2PL"</span>,Prior<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#           Example 3b.            #</span></span></span>
<span class="r-in"><span><span class="co">#        Model estimations         #</span></span></span>
<span class="r-in"><span><span class="co">#   With log-linear att structure  #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- DINA model with loglinear smoothed attribute space ---#</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="va">mod23</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"DINA"</span>,att.dist<span class="op">=</span><span class="st">"loglinear"</span>,loglinear<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod23</span>,<span class="st">"lambda"</span><span class="op">)</span> <span class="co"># intercept and three main effects</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#           Example 3c.            #</span></span></span>
<span class="r-in"><span><span class="co">#        Model estimations         #</span></span></span>
<span class="r-in"><span><span class="co">#  With independent att structure  #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- GDINA model with independent attribute space ---#</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="va">mod33</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, att.dist<span class="op">=</span><span class="st">"independent"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod33</span>,<span class="st">"lambda"</span><span class="op">)</span> <span class="co"># mastery probability for each attribute</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#          Example 4.              #</span></span></span>
<span class="r-in"><span><span class="co">#        Model estimations         #</span></span></span>
<span class="r-in"><span><span class="co">#    With fixed att structure      #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- User-specified attribute priors ----#</span></span></span>
<span class="r-in"><span><span class="co"># prior distribution is fixed during calibration</span></span></span>
<span class="r-in"><span><span class="co"># Assume each of 000,100,010 and 001 has probability of 0.1</span></span></span>
<span class="r-in"><span><span class="co"># and each of 110, 101,011 and 111 has probability of 0.15</span></span></span>
<span class="r-in"><span><span class="co"># Note that the sum is equal to 1</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># fit GDINA model  with fixed prior dist.</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="va">modp1</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, att.prior <span class="op">=</span> <span class="va">prior</span>, att.dist <span class="op">=</span> <span class="st">"fixed"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="extract.html">extract</a></span><span class="op">(</span><span class="va">modp1</span>, what <span class="op">=</span> <span class="st">"att.prior"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#          Example 5a.             #</span></span></span>
<span class="r-in"><span><span class="co">#             G-DINA               #</span></span></span>
<span class="r-in"><span><span class="co"># with hierarchical att structure  #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- User-specified attribute structure ----#</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim30GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># divergent structure A1-&gt;A2-&gt;A3;A1-&gt;A4-&gt;A5</span></span></span>
<span class="r-in"><span><span class="va">diverg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">struc</span> <span class="op">&lt;-</span> <span class="fu"><a href="att.structure.html">att.structure</a></span><span class="op">(</span><span class="va">diverg</span>,<span class="va">K</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># data simulation</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">true.lc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">^</span><span class="va">K</span><span class="op">)</span>,<span class="va">N</span>,replace<span class="op">=</span><span class="cn">TRUE</span>,prob<span class="op">=</span><span class="va">struc</span><span class="op">$</span><span class="va">att.prob</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">true.lc</span><span class="op">)</span> <span class="co">#check the sample</span></span></span>
<span class="r-in"><span><span class="va">true.att</span> <span class="op">&lt;-</span> <span class="fu"><a href="attributepattern.html">attributepattern</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span><span class="op">[</span><span class="va">true.lc</span>,<span class="op">]</span></span></span>
<span class="r-in"><span> <span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># data simulation</span></span></span>
<span class="r-in"><span> <span class="va">simD</span> <span class="op">&lt;-</span> <span class="fu"><a href="simGDINA.html">simGDINA</a></span><span class="op">(</span><span class="va">N</span>,<span class="va">Q</span>,gs.parm <span class="op">=</span> <span class="va">gs</span>, model <span class="op">=</span> <span class="st">"GDINA"</span>,attribute <span class="op">=</span> <span class="va">true.att</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="extract.html">extract</a></span><span class="op">(</span><span class="va">simD</span>,<span class="st">"dat"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">modp1</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, att.str <span class="op">=</span> <span class="va">diverg</span>, att.dist <span class="op">=</span> <span class="st">"saturated"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">modp1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">modp1</span>,<span class="st">"lambda"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#          Example 5b.             #</span></span></span>
<span class="r-in"><span><span class="co">#   Reduced model (e.g.,ACDM)      #</span></span></span>
<span class="r-in"><span><span class="co"># with hierarchical att structure  #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- User-specified attribute structure ----#</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim30GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># linear structure A1-&gt;A2-&gt;A3-&gt;A4-&gt;A5</span></span></span>
<span class="r-in"><span><span class="va">linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">struc</span> <span class="op">&lt;-</span> <span class="fu"><a href="att.structure.html">att.structure</a></span><span class="op">(</span><span class="va">linear</span>,<span class="va">K</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># data simulation</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">true.lc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">^</span><span class="va">K</span><span class="op">)</span>,<span class="va">N</span>,replace<span class="op">=</span><span class="cn">TRUE</span>,prob<span class="op">=</span><span class="va">struc</span><span class="op">$</span><span class="va">att.prob</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">true.lc</span><span class="op">)</span> <span class="co">#check the sample</span></span></span>
<span class="r-in"><span><span class="va">true.att</span> <span class="op">&lt;-</span> <span class="fu"><a href="attributepattern.html">attributepattern</a></span><span class="op">(</span><span class="va">K</span><span class="op">)</span><span class="op">[</span><span class="va">true.lc</span>,<span class="op">]</span></span></span>
<span class="r-in"><span> <span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># data simulation</span></span></span>
<span class="r-in"><span> <span class="va">simD</span> <span class="op">&lt;-</span> <span class="fu"><a href="simGDINA.html">simGDINA</a></span><span class="op">(</span><span class="va">N</span>,<span class="va">Q</span>,gs.parm <span class="op">=</span> <span class="va">gs</span>, model <span class="op">=</span> <span class="st">"ACDM"</span>,attribute <span class="op">=</span> <span class="va">true.att</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="extract.html">extract</a></span><span class="op">(</span><span class="va">simD</span>,<span class="st">"dat"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">modp1</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"ACDM"</span>,</span></span>
<span class="r-in"><span>               att.str <span class="op">=</span> <span class="va">linear</span>, att.dist <span class="op">=</span> <span class="st">"saturated"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">modp1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">modp1</span>,<span class="st">"lambda"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#           Example 6.             #</span></span></span>
<span class="r-in"><span><span class="co"># Specify initial values for item  #</span></span></span>
<span class="r-in"><span><span class="co"># parameters                       #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># check initials to see the format for initial item parameters</span></span></span>
<span class="r-in"><span> <span class="va">initials</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simItempar</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span> <span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span> <span class="va">mod.initial</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span><span class="va">dat</span>,<span class="va">Q</span>,catprob.parm <span class="op">=</span> <span class="va">initials</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># compare initial item parameters</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">initials</span>,<span class="fu"><a href="extract.html">extract</a></span><span class="op">(</span><span class="va">mod.initial</span>,<span class="st">"initial.catprob"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#           Example 7a.            #</span></span></span>
<span class="r-in"><span><span class="co"># Fix item and structure parameters#</span></span></span>
<span class="r-in"><span><span class="co"># Estimate person attribute profile#</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># check initials to see the format for initial item parameters</span></span></span>
<span class="r-in"><span> <span class="va">initials</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simItempar</span></span></span>
<span class="r-in"><span> <span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span> <span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span> <span class="va">mod.ini</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span><span class="va">dat</span>,<span class="va">Q</span>,catprob.parm <span class="op">=</span> <span class="va">initials</span>,att.prior <span class="op">=</span> <span class="va">prior</span>,</span></span>
<span class="r-in"><span>                  att.dist <span class="op">=</span> <span class="st">"fixed"</span>,control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxitr <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="personparm.html">personparm</a></span><span class="op">(</span><span class="va">mod.ini</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># compare item parameters</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">initials</span>,<span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod.ini</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#           Example 7b.            #</span></span></span>
<span class="r-in"><span><span class="co">#   Fix parameters for some items  #</span></span></span>
<span class="r-in"><span><span class="co"># Estimate person attribute profile#</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># check initials to see the format for initial item parameters</span></span></span>
<span class="r-in"><span> <span class="va">initials</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simItempar</span></span></span>
<span class="r-in"><span> <span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span> <span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span> <span class="co"># fix parameters of the first 5 items; do not fix mixing proportion parameters</span></span></span>
<span class="r-in"><span> <span class="va">mod.ini</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span><span class="va">dat</span>,<span class="va">Q</span>,catprob.parm <span class="op">=</span> <span class="va">initials</span>,</span></span>
<span class="r-in"><span>                  att.dist <span class="op">=</span> <span class="st">"saturated"</span>,control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxitr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2000</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="personparm.html">personparm</a></span><span class="op">(</span><span class="va">mod.ini</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># compare item parameters</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">initials</span>,<span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mod.ini</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#           Example 8.             #</span></span></span>
<span class="r-in"><span><span class="co">#        polytomous attribute      #</span></span></span>
<span class="r-in"><span><span class="co">#          model estimation        #</span></span></span>
<span class="r-in"><span><span class="co">#    see Chen, de la Torre 2013    #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- polytomous attribute G-DINA model --- #</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim30pGDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim30pGDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="co">#polytomous G-DINA model</span></span></span>
<span class="r-in"><span><span class="va">pout</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span><span class="va">dat</span>,<span class="va">Q</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ----- polymous DINA model --------#</span></span></span>
<span class="r-in"><span><span class="va">pout2</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span><span class="va">dat</span>,<span class="va">Q</span>,model<span class="op">=</span><span class="st">"DINA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">pout</span>,<span class="va">pout2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#           Example 9.             #</span></span></span>
<span class="r-in"><span><span class="co">#        Sequential G-DINA model   #</span></span></span>
<span class="r-in"><span><span class="co">#    see Ma, &amp; de la Torre 2016    #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- polytomous attribute G-DINA model --- #</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim20seqGDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim20seqGDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="va">Q</span></span></span>
<span class="r-in"><span><span class="co">#    Item Cat A1 A2 A3 A4 A5</span></span></span>
<span class="r-in"><span><span class="co">#       1   1  1  0  0  0  0</span></span></span>
<span class="r-in"><span><span class="co">#       1   2  0  1  0  0  0</span></span></span>
<span class="r-in"><span><span class="co">#       2   1  0  0  1  0  0</span></span></span>
<span class="r-in"><span><span class="co">#       2   2  0  0  0  1  0</span></span></span>
<span class="r-in"><span><span class="co">#       3   1  0  0  0  0  1</span></span></span>
<span class="r-in"><span><span class="co">#       3   2  1  0  0  0  0</span></span></span>
<span class="r-in"><span><span class="co">#       4   1  0  0  0  0  1</span></span></span>
<span class="r-in"><span><span class="co">#       ...</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#sequential G-DINA model</span></span></span>
<span class="r-in"><span><span class="va">sGDINA</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span><span class="va">dat</span>,<span class="va">Q</span>,sequential <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sDINA</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span><span class="va">dat</span>,<span class="va">Q</span>,sequential <span class="op">=</span> <span class="cn">TRUE</span>,model <span class="op">=</span> <span class="st">"DINA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">sGDINA</span>,<span class="va">sDINA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">sDINA</span><span class="op">)</span> <span class="co"># processing function</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">sDINA</span>,<span class="st">"itemprob"</span><span class="op">)</span> <span class="co"># success probabilities for each item</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">sDINA</span>,<span class="st">"LCprob"</span><span class="op">)</span> <span class="co"># success probabilities for each category for all latent classes</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#           Example 10a.           #</span></span></span>
<span class="r-in"><span><span class="co">#    Multiple-Group G-DINA model   #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># parameter simulation</span></span></span>
<span class="r-in"><span><span class="co"># Group 1 - female</span></span></span>
<span class="r-in"><span><span class="va">N1</span> <span class="op">&lt;-</span> <span class="fl">3000</span></span></span>
<span class="r-in"><span><span class="va">gs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Group 2 - male</span></span></span>
<span class="r-in"><span><span class="va">N2</span> <span class="op">&lt;-</span> <span class="fl">3000</span></span></span>
<span class="r-in"><span><span class="va">gs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># data simulation for each group</span></span></span>
<span class="r-in"><span><span class="va">sim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="simGDINA.html">simGDINA</a></span><span class="op">(</span><span class="va">N1</span>,<span class="va">Q</span>,gs.parm <span class="op">=</span> <span class="va">gs1</span>,model <span class="op">=</span> <span class="st">"DINA"</span>,att.dist <span class="op">=</span> <span class="st">"higher.order"</span>,</span></span>
<span class="r-in"><span>                 higher.order.parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="va">K</span><span class="op">)</span>,b<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span>,length.out<span class="op">=</span><span class="va">K</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="simGDINA.html">simGDINA</a></span><span class="op">(</span><span class="va">N2</span>,<span class="va">Q</span>,gs.parm <span class="op">=</span> <span class="va">gs2</span>,model <span class="op">=</span> <span class="st">"DINO"</span>,att.dist <span class="op">=</span> <span class="st">"higher.order"</span>,</span></span>
<span class="r-in"><span>                 higher.order.parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">K</span><span class="op">)</span>,b<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>,length.out<span class="op">=</span><span class="va">K</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># combine data - all items have the same item parameters</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="extract.html">extract</a></span><span class="op">(</span><span class="va">sim1</span>,<span class="st">"dat"</span><span class="op">)</span>,<span class="fu"><a href="extract.html">extract</a></span><span class="op">(</span><span class="va">sim2</span>,<span class="st">"dat"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3000</span>,<span class="fl">3000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Fit G-DINA model</span></span></span>
<span class="r-in"><span><span class="va">mg.est</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>,Q <span class="op">=</span> <span class="va">Q</span>,group <span class="op">=</span> <span class="va">gr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mg.est</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="extract.html">extract</a></span><span class="op">(</span><span class="va">mg.est</span>,<span class="st">"posterior.prob"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mg.est</span>,<span class="st">"lambda"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#           Example 10b.           #</span></span></span>
<span class="r-in"><span><span class="co">#    Multiple-Group G-DINA model   #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim30GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># parameter simulation</span></span></span>
<span class="r-in"><span><span class="va">N1</span> <span class="op">&lt;-</span> <span class="fl">3000</span></span></span>
<span class="r-in"><span><span class="va">gs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N2</span> <span class="op">&lt;-</span> <span class="fl">3000</span></span></span>
<span class="r-in"><span><span class="va">gs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># data simulation for each group</span></span></span>
<span class="r-in"><span><span class="co"># two groups have different theta distributions</span></span></span>
<span class="r-in"><span><span class="va">sim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="simGDINA.html">simGDINA</a></span><span class="op">(</span><span class="va">N1</span>,<span class="va">Q</span>,gs.parm <span class="op">=</span> <span class="va">gs1</span>,model <span class="op">=</span> <span class="st">"DINA"</span>,att.dist <span class="op">=</span> <span class="st">"higher.order"</span>,</span></span>
<span class="r-in"><span>                 higher.order.parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">K</span><span class="op">)</span>,b<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>,length.out<span class="op">=</span><span class="va">K</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="simGDINA.html">simGDINA</a></span><span class="op">(</span><span class="va">N2</span>,<span class="va">Q</span>,gs.parm <span class="op">=</span> <span class="va">gs2</span>,model <span class="op">=</span> <span class="st">"DINO"</span>,att.dist <span class="op">=</span> <span class="st">"higher.order"</span>,</span></span>
<span class="r-in"><span>                 higher.order.parm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">N2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">K</span><span class="op">)</span>,b<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>,length.out<span class="op">=</span><span class="va">K</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># combine data - different groups have distinct item parameters</span></span></span>
<span class="r-in"><span><span class="co"># see ?bdiagMatrix</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="bdiagMatrix.html">bdiagMatrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="extract.html">extract</a></span><span class="op">(</span><span class="va">sim1</span>,<span class="st">"dat"</span><span class="op">)</span>,<span class="fu"><a href="extract.html">extract</a></span><span class="op">(</span><span class="va">sim2</span>,<span class="st">"dat"</span><span class="op">)</span><span class="op">)</span>,fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">Q</span>,<span class="va">Q</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3000</span>,<span class="fl">3000</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mg.est</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>,Q <span class="op">=</span> <span class="va">Q</span>,group <span class="op">=</span> <span class="va">gr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Fit G-DINA model</span></span></span>
<span class="r-in"><span><span class="va">mg.est</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>,Q <span class="op">=</span> <span class="va">Q</span>,group <span class="op">=</span> <span class="va">gr</span>,att.dist<span class="op">=</span><span class="st">"higher.order"</span>,</span></span>
<span class="r-in"><span>higher.order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"Rasch"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mg.est</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">mg.est</span>,<span class="st">"lambda"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="personparm.html">personparm</a></span><span class="op">(</span><span class="va">mg.est</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="personparm.html">personparm</a></span><span class="op">(</span><span class="va">mg.est</span>,<span class="st">"HO"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="extract.html">extract</a></span><span class="op">(</span><span class="va">mg.est</span>,<span class="st">"posterior.prob"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#           Example 11.            #</span></span></span>
<span class="r-in"><span><span class="co">#           Bug DINO model         #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim10GDINA</span><span class="op">$</span><span class="va">simQ</span> <span class="co"># 1 represents misconceptions/bugs</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>guess<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="va">J</span><span class="op">)</span>,slip<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="va">J</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="simGDINA.html">simGDINA</a></span><span class="op">(</span><span class="va">N</span>,<span class="va">Q</span>,gs.parm <span class="op">=</span> <span class="va">gs</span>,model <span class="op">=</span> <span class="st">"BUGDINO"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="extract.html">extract</a></span><span class="op">(</span><span class="va">sim</span>,<span class="st">"dat"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat<span class="op">=</span><span class="va">dat</span>,Q<span class="op">=</span><span class="va">Q</span>,model <span class="op">=</span> <span class="st">"BUGDINO"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">est</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#           Example 12.            #</span></span></span>
<span class="r-in"><span><span class="co">#           SISM model             #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The Q-matrix used in Kuo, et al (2018)</span></span></span>
<span class="r-in"><span><span class="co"># The first four columns are for Attributes 1-4</span></span></span>
<span class="r-in"><span><span class="co"># The last three columns are for Bugs 1-3</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>,ncol <span class="op">=</span> <span class="fl">7</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>guess<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="va">J</span><span class="op">)</span>,slip<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="va">J</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="simGDINA.html">simGDINA</a></span><span class="op">(</span><span class="va">N</span>,<span class="va">Q</span>,gs.parm <span class="op">=</span> <span class="va">gs</span>,model <span class="op">=</span> <span class="st">"SISM"</span>,no.bugs<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="extract.html">extract</a></span><span class="op">(</span><span class="va">sim</span>,<span class="st">"dat"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat<span class="op">=</span><span class="va">dat</span>,Q<span class="op">=</span><span class="va">Q</span>,model<span class="op">=</span><span class="st">"SISM"</span>,no.bugs<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">est</span>,<span class="st">"delta"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#           Example 13a.           #</span></span></span>
<span class="r-in"><span><span class="co">#     user specified design matrix #</span></span></span>
<span class="r-in"><span><span class="co">#        LCDM (logit G-DINA)       #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim30GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim30GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># LCDM</span></span></span>
<span class="r-in"><span><span class="va">lcdm</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"logitGDINA"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>conv.type<span class="op">=</span><span class="st">"neg2LL"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Another way is to find design matrix for each item first =&gt; must be a list</span></span></span>
<span class="r-in"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span>,<span class="va">designmatrix</span>,model<span class="op">=</span><span class="st">"GDINA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># for comparison, use change in -2LL as convergence criterion</span></span></span>
<span class="r-in"><span><span class="co"># LCDM</span></span></span>
<span class="r-in"><span><span class="va">lcdm2</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"UDF"</span>, design.matrix <span class="op">=</span> <span class="va">D</span>,</span></span>
<span class="r-in"><span>linkfunc <span class="op">=</span> <span class="st">"logit"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>conv.type<span class="op">=</span><span class="st">"neg2LL"</span><span class="op">)</span>,solver<span class="op">=</span><span class="st">"slsqp"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># identity link GDINA</span></span></span>
<span class="r-in"><span><span class="va">iGDINA</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"GDINA"</span>,</span></span>
<span class="r-in"><span>control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>conv.type<span class="op">=</span><span class="st">"neg2LL"</span><span class="op">)</span>,solver<span class="op">=</span><span class="st">"slsqp"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare all three models =&gt; identical</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">lcdm</span>,<span class="va">lcdm2</span>,<span class="va">iGDINA</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#           Example 13b.           #</span></span></span>
<span class="r-in"><span><span class="co">#     user specified design matrix #</span></span></span>
<span class="r-in"><span><span class="co">#            RRUM                  #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim30GDINA</span><span class="op">$</span><span class="va">simdat</span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="va">sim30GDINA</span><span class="op">$</span><span class="va">simQ</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specify design matrix for each item =&gt; must be a list</span></span></span>
<span class="r-in"><span><span class="co"># D can be defined by the user</span></span></span>
<span class="r-in"><span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">Q</span><span class="op">)</span>,<span class="va">designmatrix</span>,model<span class="op">=</span><span class="st">"ACDM"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># for comparison, use change in -2LL as convergence criterion</span></span></span>
<span class="r-in"><span><span class="co"># RRUM</span></span></span>
<span class="r-in"><span><span class="va">logACDM</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"UDF"</span>, design.matrix <span class="op">=</span> <span class="va">D</span>,</span></span>
<span class="r-in"><span>linkfunc <span class="op">=</span> <span class="st">"log"</span>, control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>conv.type<span class="op">=</span><span class="st">"neg2LL"</span><span class="op">)</span>,solver<span class="op">=</span><span class="st">"slsqp"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># identity link GDINA</span></span></span>
<span class="r-in"><span><span class="va">RRUM</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat</span>, Q <span class="op">=</span> <span class="va">Q</span>, model <span class="op">=</span> <span class="st">"RRUM"</span>,</span></span>
<span class="r-in"><span>              control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>conv.type<span class="op">=</span><span class="st">"neg2LL"</span><span class="op">)</span>,solver<span class="op">=</span><span class="st">"slsqp"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare two models =&gt; identical</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">logACDM</span>,<span class="va">RRUM</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span><span class="co">#           Example 14.            #</span></span></span>
<span class="r-in"><span><span class="co">#     Multiple-strategy DINA model #</span></span></span>
<span class="r-in"><span><span class="co">####################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,</span></span>
<span class="r-in"><span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,</span></span>
<span class="r-in"><span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,</span></span>
<span class="r-in"><span><span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,ncol <span class="op">=</span> <span class="fl">5</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  item1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  item2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  item3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  item4<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  item5<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="simGDINA.html">simGDINA</a></span><span class="op">(</span>N<span class="op">=</span><span class="fl">1000</span>,Q <span class="op">=</span> <span class="va">Q</span>, delta.parm <span class="op">=</span> <span class="va">d</span>,</span></span>
<span class="r-in"><span>               model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MSDINA"</span>,<span class="st">"MSDINA"</span>,<span class="st">"DINA"</span>,</span></span>
<span class="r-in"><span>                         <span class="st">"DINA"</span>,<span class="st">"DINA"</span>,<span class="st">"MSDINA"</span>,<span class="st">"MSDINA"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulated data</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="extract.html">extract</a></span><span class="op">(</span><span class="va">sim</span>,what <span class="op">=</span> <span class="st">"dat"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># estimation</span></span></span>
<span class="r-in"><span><span class="co"># MSDINA need to be specified for each strategy</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">GDINA</span><span class="op">(</span><span class="va">dat</span>,<span class="va">Q</span>,model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MSDINA"</span>,<span class="st">"MSDINA"</span>,<span class="st">"DINA"</span>,</span></span>
<span class="r-in"><span>                             <span class="st">"DINA"</span>,<span class="st">"DINA"</span>,<span class="st">"MSDINA"</span>,<span class="st">"MSDINA"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">est</span>,<span class="st">"delta"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Wenchao Ma, Jimmy de la Torre.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer></div>






  </body></html>

